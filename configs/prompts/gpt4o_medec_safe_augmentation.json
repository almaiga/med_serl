{
  "metadata": {
    "version": "2.1",
    "safe_augmentation_strategy": "Use MEDEC errors as-is (doctor-verified). Minimal paraphrasing (1 sentence) for CORRECT. 50/50 split for calibration.",
    "key_principles": [
      "NEVER generate new errors (too risky without MD verification)",
      "Use MEDEC incorrect_note directly (already verified)",
      "Generate CORRECT with MINIMAL paraphrasing (1 sentence only - easy to verify)",
      "50/50 CORRECT/INCORRECT ratio for model calibration",
      "Add reasoning to BOTH CORRECT and INCORRECT (teaches task understanding)",
      "CORRECT reasoning: Why paraphrase is SAFE (preserves facts)",
      "INCORRECT reasoning: Why error is PLAUSIBLE but wrong (deception strategy)",
      "SFT teaches format, RL drives creativity - keep SFT simple!"
    ],
    "why_minimal_paraphrasing": [
      "Easy to verify correctness (hard with heavy paraphrasing)",
      "SFT just teaches task format, not deception",
      "RL phase handles creativity and adversarial learning",
      "Prevents verification errors from complex paraphrasing"
    ]
  },

  "correct_paraphrase_system": "You are a clinical documentation expert creating REALISTIC but SAFE paraphrases for adversarial training.\n\n**Goal:** Make a change that mimics real clinical documentation variations - the kind that happen in practice but preserve medical accuracy. Train the model to verify carefully!\n\n**CRITICAL RULE: Make EXACTLY ONE change:**\n- Choose EXACTLY ONE strategy from the list below\n- Apply it to EXACTLY ONE location in the note (one sentence, one value, or one term)\n- Do NOT make multiple changes\n- Do NOT combine strategies\n- Keep the rest of the note IDENTICAL to the original\n\n**Realistic Safe Paraphrase Strategies (choose ONE per note):**\n\n**Strategy 1: TEMPORAL EQUIVALENCE** (Same duration, different units)\n- What happens in practice: Clinicians express time differently but mean the same thing\n- Examples:\n  • \"3 days ago\" → \"72 hours prior to presentation\"\n  • \"for 1 week\" → \"over a 7-day period\"\n  • \"started 2 months ago\" → \"began 8 weeks ago\"\n  • \"1-year history\" → \"12-month history\"\n- Why safe: Mathematical equivalence (3 days = 72 hours)\n- Why realistic: Different documentation styles across providers\n- Apply to: ONLY ONE temporal phrase in the entire note\n\n**Strategy 2: CLINICAL TERMINOLOGY PRECISION** (Lay ↔ Medical term for SAME condition)\n- What happens in practice: Different providers use different terminology levels\n- Examples:\n  • \"hearing voices\" → \"auditory hallucinations\"\n  • \"shortness of breath\" → \"dyspnea\"\n  • \"high blood sugar\" → \"hyperglycemia\"\n  • \"confused\" → \"altered mental status\"\n  • \"committed suicide\" → \"died by suicide\" (preferred phrasing)\n- Why safe: Same symptom/condition, just different terminology\n- Why realistic: Academic vs community hospital documentation styles\n- Apply to: ONLY ONE term in the entire note\n\n**Strategy 3: ANATOMICAL/LATERALITY DETAIL** (Add specific anatomical context)\n- What happens in practice: Some notes include anatomical detail, others don't\n- Examples:\n  • \"blood pressure 140/90\" → \"brachial blood pressure 140/90 mmHg\"\n  • \"lung crackles\" → \"bilateral basilar lung crackles\"\n  • \"abdominal pain\" → \"periumbilical abdominal pain\"\n  • \"weakness\" → \"right-sided weakness\"\n- Why safe: Added detail doesn't contradict (if bilateral/unspecified, adding location is safe if consistent with context)\n- Why realistic: Attending adds detail during rounds\n- Apply to: ONLY ONE finding in the entire note\n- CRITICAL: Only add detail that's consistent with note context (don't invent laterality)\n\n**Strategy 4: MEASUREMENT UNIT CONVERSION** (Same value, standard units)\n- What happens in practice: US vs international units, different hospital systems\n- Examples:\n  • \"Weight 70 kg\" → \"Weight 154 lbs\" (1 kg = 2.2 lbs)\n  • \"Temp 37.8°C\" → \"Temp 100.0°F\" (conversion formula)\n  • \"Height 175 cm\" → \"Height 69 inches\"\n- Why safe: Mathematical conversion (same value)\n- Why realistic: Different hospital EMR systems use different units\n- Apply to: ONLY ONE measurement in the entire note\n- CRITICAL: Must use correct conversion (verify math!)\n\n**Strategy 5: MEDICATION INDICATION CONTEXT** (Add implied indication)\n- What happens in practice: Some notes state why medication is given, others don't\n- Examples:\n  • \"metformin 1000mg BID\" → \"metformin 1000mg BID for diabetes management\"\n  • \"lisinopril 10mg daily\" → \"lisinopril 10mg daily for hypertension\"\n  • \"aspirin 81mg\" → \"aspirin 81mg for cardiovascular prophylaxis\"\n- Why safe: Indication is already implied by diagnosis in note\n- Why realistic: Teaching hospitals vs community documentation\n- Apply to: ONLY ONE medication in the entire note\n- CRITICAL: Only add indication that's already stated elsewhere in note\n\n**Examples of CORRECT single changes:**\n✅ GOOD: Only change \"hearing voices\" → \"auditory hallucinations\" (Strategy 2)\n✅ GOOD: Only change \"3 days ago\" → \"72 hours prior\" (Strategy 1)\n✅ GOOD: Only change \"blood pressure 140/90\" → \"brachial blood pressure 140/90 mmHg\" (Strategy 3)\n✅ GOOD: Only change \"Weight 70 kg\" → \"Weight 154 lbs\" (Strategy 4)\n\n**Examples of WRONG multiple changes:**\n❌ BAD: Change \"hearing voices\" AND \"3 days ago\" (multiple strategies)\n❌ BAD: Change multiple lab values or multiple medications\n❌ BAD: Swap multiple medical terms in different sentences\n❌ BAD: Trivial changes like \"note\" → \"observe\", \"presents\" → \"visits\"\n\n**CRITICAL SAFETY RULES - NEVER change:**\n- Numerical values (except unit conversion with correct math)\n- Drug names, doses, or frequencies\n- Diagnoses (can change terminology but not the condition)\n- Timeline duration (can change units but not length)\n- Lab values (no modifications at all)\n\n**VERIFICATION REQUIREMENT:**\nBefore outputting, verify:\n1. Only ONE thing changed in the entire note\n2. Everything else is IDENTICAL to the original (use ctrl+F to check)\n3. The change is realistic (happens in real clinical documentation)\n4. The change preserves medical accuracy\n\n**Output:** Only the modified note. No explanations.",

  "correct_paraphrase_user": "Make EXACTLY ONE realistic but safe change to this note using ONE of the 5 strategies.\n\n**Pick ONE strategy:**\n1. TEMPORAL EQUIVALENCE: Change one time phrase to equivalent units (\"3 days\" → \"72 hours\")\n2. CLINICAL TERMINOLOGY: Swap one lay/medical term (\"hearing voices\" → \"auditory hallucinations\")\n3. ANATOMICAL DETAIL: Add anatomical specificity to one finding (\"BP 140/90\" → \"brachial BP 140/90 mmHg\")\n4. UNIT CONVERSION: Convert one measurement to standard units (\"70 kg\" → \"154 lbs\")\n5. MEDICATION CONTEXT: Add indication to one medication (\"metformin\" → \"metformin for diabetes\")\n\n**CRITICAL:**\n- Apply ONLY to ONE location in the entire note\n- Keep everything else IDENTICAL (verify with ctrl+F)\n- Change must be medically safe and realistic\n\n**Note:**\n{note}\n\n**Output:** Only the modified note with EXACTLY ONE change. No explanations.",

  "correct_reasoning_system": "You are a medical AI training expert explaining safe paraphrasing strategies with step-by-step reasoning.\n\n**Context:** You're teaching a model HOW to verify that changes preserve medical accuracy.\n\n**Task:** Given a paraphrased note, provide chain-of-thought reasoning showing the verification process:\n1. **What changed** - Identify the specific modification\n2. **Verification steps** - Show HOW you checked it's safe\n3. **Why it's safe** - Conclude based on verification\n4. **Strategy used** - Which of the 5 strategies was applied\n\n**Perspective:** Write from the PARAPHRASER's viewpoint showing your reasoning process.\n\n**Output JSON:**\n```json\n{\n  \"change_made\": \"[What specific text was changed]\",\n  \"verification_chain\": [\n    \"Step 1: Identify change scope - [what changed and what didn't]\",\n    \"Step 2: Check medical equivalence - [verify terms/values mean same thing]\",\n    \"Step 3: Verify facts preserved - [list critical facts unchanged]\",\n    \"Step 4: Confirm strategy applied correctly - [which strategy and why it works]\"\n  ],\n  \"why_safe\": \"[Summary: why this change preserves medical accuracy]\",\n  \"strategy_used\": \"[Strategy 1-5: name of strategy applied]\",\n  \"preserved_facts\": [\"Critical fact 1\", \"Critical fact 2\", \"Critical fact 3\"]\n}\n```\n\n**Example with Chain-of-Thought:**\n```json\n{\n  \"change_made\": \"Changed 'hearing voices' to 'auditory hallucinations'\",\n  \"verification_chain\": [\n    \"Step 1: Only one term changed - 'hearing voices' → 'auditory hallucinations', rest of note identical\",\n    \"Step 2: Check medical equivalence - both terms describe perceiving sounds without external stimulus\",\n    \"Step 3: Verify all facts preserved - patient age (42), timeline (1-year history), other symptoms (irritability, restlessness) all unchanged\",\n    \"Step 4: Strategy 2 (Clinical Terminology) applied correctly - swapped lay term for medical equivalent\"\n  ],\n  \"why_safe\": \"'Auditory hallucinations' is the formal medical term for 'hearing voices'. Both describe the same symptom. All other clinical facts (timeline, associated symptoms, patient demographics) preserved exactly.\",\n  \"strategy_used\": \"Strategy 2: CLINICAL TERMINOLOGY PRECISION\",\n  \"preserved_facts\": [\"42-year-old patient\", \"1-year history of abnormal behavior\", \"Irritability and restlessness unchanged\", \"All other symptoms identical\"]\n}\n```",

  "correct_reasoning_user": "Explain why this paraphrase is SAFE:\n\n**Original note:**\n{original_note}\n\n**Paraphrased note:**\n{paraphrased_note}\n\nExplain from the PARAPHRASER's perspective:\n- What did I change?\n- Why is this change safe (preserves medical facts)?\n- What critical facts stayed the same?\n- What paraphrase technique did I use?\n\nOutput in JSON format:",

  "reasoning_system": "You are a medical AI training expert explaining error injection strategies with step-by-step reasoning.\n\n**Context:** You're teaching an injector model HOW to create realistic, deceptive medical errors.\n\n**Task:** Given a clinical note pair, provide chain-of-thought reasoning showing the injection process:\n1. **What changed** - The specific error introduced\n2. **Deception chain** - Step-by-step: HOW you made it plausible\n3. **Why it fools assessor** - What makes detection difficult\n4. **Detection strategy** - What assessor must check to catch it\n\n**Perspective:** Write from the INJECTOR's viewpoint showing your strategic reasoning.\n\n**Output JSON:**\n```json\n{\n  \"injection_strategy\": \"[What specific change was made]\",\n  \"deception_chain\": [\n    \"Step 1: Identify similar alternative - [find plausible wrong option]\",\n    \"Step 2: Verify symptom overlap - [check overlapping presentation]\",\n    \"Step 3: Locate subtle differentiator - [find what distinguishes them]\",\n    \"Step 4: Bet assessor misses it - [why detection is hard]\"\n  ],\n  \"why_plausible\": \"[Why this error looks realistic]\",\n  \"detection_requires\": \"[What assessor must do to catch error]\",\n  \"detection_clues\": [\"Clue 1\", \"Clue 2\", \"Clue 3\"],\n  \"error_type_pattern\": \"[General pattern this follows]\"\n}\n```\n\n**Example with Chain-of-Thought:**\n```json\n{\n  \"injection_strategy\": \"Changed 'Huntington disease' to 'Creutzfeldt-Jakob disease'\",\n  \"deception_chain\": [\n    \"Step 1: Found similar disease - both neurodegenerative with movement disorders and cognitive decline\",\n    \"Step 2: Verified symptom overlap - confusion, abnormal movements, psychiatric symptoms fit both\",\n    \"Step 3: Located subtle differentiator - family history (genetic Huntington vs sporadic CJD) and timeline (1-year insidious vs rapid weeks-months)\",\n    \"Step 4: Bet assessor won't check carefully - family history buried in social history section, easy to miss genetic pattern\"\n  ],\n  \"why_plausible\": \"Both are rare neurodegenerative diseases with overlapping symptoms (movement disorders, cognitive decline, psychiatric features). Without careful family history analysis, they appear similar.\",\n  \"detection_requires\": \"Assessor must: (1) recognize family history pattern (father's suicide at 50 suggests genetic disease), (2) check timeline (1-year progression too slow for CJD), (3) note specific movement type (choreiform movements more typical of Huntington)\",\n  \"detection_clues\": [\n    \"Father committed suicide at 50 - suggests genetic autosomal dominant condition (Huntington)\",\n    \"1-year insidious progression - too slow for CJD (usually weeks-months)\",\n    \"Choreiform movements - more characteristic of Huntington than CJD\"\n  ],\n  \"error_type_pattern\": \"Similar disease presentations requiring differential diagnosis\"\n}\n```",

  "reasoning_user": "Explain the injector's strategy for this error:\n\n**Original (correct) note:**\n{correct_note}\n\n**Injected (incorrect) note:**\n{incorrect_note}\n\n**What was changed:** {error_sentence} → {corrected_sentence}\n**Error type:** {error_type}\n\nExplain from the INJECTOR's perspective:\n- What change did I make?\n- Why is this error plausible/deceptive?\n- Why might this fool an assessor?\n- What pattern does this follow?\n\nOutput in JSON format:",

  "sft_data_generation": {
    "description": "Generate 50/50 CORRECT/INCORRECT training data from MEDEC",
    "process": [
      "1. Load MEDEC pairs (each has correct_note and incorrect_note)",
      "2. For CORRECT examples: Use GPT-4o to paraphrase correct_note (safe - no medical risk)",
      "3. For INCORRECT examples: Use MEDEC incorrect_note AS-IS (already doctor-verified)",
      "4. Optional: Add reasoning to INCORRECT examples (explain why error is wrong)",
      "5. Output: 50% CORRECT paraphrases, 50% INCORRECT from MEDEC",
      "6. Label format: {\"note\": \"...\", \"label\": \"CORRECT\"/\"INCORRECT\", \"reasoning\": \"...\"}"
    ],
    "rationale": {
      "why_safe": "Only paraphrase CORRECT notes (no medical risk). Use MEDEC errors as-is (doctor-verified).",
      "why_50_50": "Balanced dataset prevents model from biasing toward CORRECT or INCORRECT",
      "why_no_new_errors": "Generating errors requires MD verification - too risky and expensive"
    }
  },

  "output_format": {
    "correct_example": {
      "note": "[Paraphrased clinical note from GPT-4o]",
      "label": "CORRECT",
      "original_note_id": "ms-train-418",
      "source": "medec_correct_paraphrased",
      "reasoning": {
        "change_made": "Changed 'Patient has type 2 diabetes' to 'Patient presents with type 2 diabetes'",
        "why_safe": "Only the verb changed (has → presents with), diagnosis and all medical facts preserved exactly",
        "preserved_facts": ["Diagnosis: type 2 diabetes", "All medications unchanged", "All lab values unchanged"],
        "paraphrase_technique": "Synonym substitution for verb (medically equivalent phrasing)",
        "medical_equivalence": "Both 'has' and 'presents with' indicate the patient's current diagnosis - no change in clinical meaning"
      }
    },
    "incorrect_example": {
      "note": "[MEDEC incorrect_note AS-IS]",
      "label": "INCORRECT",
      "original_note_id": "ms-train-418",
      "error_type": "diagnosis",
      "error_location": "Suspected of Creutzfeldt-Jakob disease.",
      "correction": "Suspected of Huntington disease.",
      "source": "medec_incorrect_verified",
      "reasoning": {
        "error_identified": "Misdiagnosis: CJD instead of Huntington",
        "why_wrong": "Family history of father suicide at 50 suggests genetic Huntington (autosomal dominant, typical onset 30s-50s). Choreiform movements and 1-year insidious progression fit Huntington, not CJD (which is rapid, weeks-months). Key clue: genetic pattern in family.",
        "key_clues": ["Father suicide at 50 (Huntington genetic)", "1-year progression (Huntington insidious, CJD rapid)", "Choreiform movements (Huntington)"],
        "correct_answer": "Huntington disease: autosomal dominant, chorea + psychiatric + cognitive decline, genetic family history",
        "clinical_impact": "Wrong diagnosis affects genetic counseling, family screening, prognosis, and support planning"
      }
    }
  },

  "generation_params": {
    "correct_paraphrase": {
      "temperature": 0.7,
      "top_p": 0.9,
      "max_tokens": 2048,
      "note": "Moderate temperature for interesting but safe paraphrasing (make model think!)"
    },
    "reasoning": {
      "temperature": 0.3,
      "top_p": 0.9,
      "max_tokens": 1024,
      "note": "Lower temperature for accurate medical reasoning"
    }
  },

  "quality_checks": {
    "for_correct_paraphrases": [
      "All numbers preserved exactly (labs, vitals, ages, doses)",
      "All medications preserved exactly",
      "All diagnoses preserved exactly",
      "Substantial variation in wording (not copy-paste)",
      "Natural, fluent clinical writing"
    ],
    "for_incorrect_medec": [
      "Use AS-IS from MEDEC (already verified)",
      "Do NOT modify or edit",
      "Do NOT try to \"fix\" or \"improve\"",
      "Trust MEDEC curation"
    ]
  },

  "example_generation": {
    "input_medec_pair": {
      "note_id": "ms-train-418",
      "correct_note": "A 42-year-old woman... Suspected of Huntington disease...",
      "incorrect_note": "A 42-year-old woman... Suspected of Creutzfeldt-Jakob disease...",
      "error_type": "diagnosis"
    },
    "output_sft_data": [
      {
        "note": "[GPT-4o paraphrase of correct_note]",
        "label": "CORRECT",
        "note_id": "ms-train-418",
        "source": "medec_correct_paraphrased"
      },
      {
        "note": "A 42-year-old woman... Suspected of Creutzfeldt-Jakob disease...",
        "label": "INCORRECT",
        "note_id": "ms-train-418",
        "error_type": "diagnosis",
        "source": "medec_incorrect_verified",
        "reasoning": {
          "injection_strategy": "Changed diagnosis from 'Huntington disease' to 'Creutzfeldt-Jakob disease'",
          "why_plausible": "Both are neurodegenerative diseases causing movement disorders, cognitive decline, and psychiatric symptoms - easy to confuse without careful analysis",
          "deception_technique": "The symptoms overlap significantly: both have abnormal movements, behavioral changes, and dementia. Without checking family history closely, they appear similar.",
          "clinical_reasoning": "This error occurs in practice because both are rare, both affect movement and cognition, and clinicians may anchor on prominent symptoms (movements, behavior) without fully considering timeline and genetics.",
          "detection_clues": ["Family history of suicide at 50 (Huntington is genetic, autosomal dominant)", "1-year insidious progression (Huntington), not rapid weeks-months (CJD)", "Choreiform movements more typical of Huntington"],
          "error_type_pattern": "Similar disease presentations - requires differential diagnosis based on subtle distinguishing features"
        }
      }
    ]
  }
}
