# MedSeRL Multi-Turn Interaction Configuration
# Two-phase game: Injector modifies note â†’ Assessor classifies
# 
# This file configures verl's multi-turn rollout system.
# Format follows verl's interaction config specification.

# Interaction handler - verl expects this format
interaction:
  - name: "medical_game"
    class_name: "scripts.self_play.interactions.medical_game_interaction.MedicalGameInteraction"
    config:
      # Prompts for Assessor (Phase 2)
      detection_prompts_path: "configs/prompts/error_detection_prompts.json"
      
      # Max turns per episode
      max_turns: 2  # Turn 1: Injector, Turn 2: Assessor
      
      # Reward values (zero-sum game)
      reward_win: 1.0
      reward_lose: -1.0
      format_bonus: 0.2

# Multi-turn rollout settings (verl-specific)
multi_turn:
  # Enable the interaction system
  enabled: true
  
  # Stop conditions
  stop_conditions:
    - type: regex
      pattern: "<answer>(CORRECT|INCORRECT)</answer>"
    - type: max_turns
      value: 2
  
  # Turn transition logic
  turn_transition: "tool_based"  # or "fixed_sequence"

# Tool definitions (if using tool_based transitions)
tools:
  - name: submit_modified_note
    description: "Submit the modified clinical note for assessment"
    parameters:
      modified_note:
        type: string
        required: true
      reasoning:
        type: string
        required: false
    
  - name: classify_note
    description: "Classify whether the note contains errors"
    parameters:
      classification:
        type: string
        enum: ["CORRECT", "INCORRECT"]
        required: true
      reasoning:
        type: string
        required: false

# Logging
logging:
  enabled: true
  log_dir: results/self_play/interactions
  log_prompts: true
  log_responses: true
  log_rewards: true
